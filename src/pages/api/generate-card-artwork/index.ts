import { NextApiRequest, NextApiResponse } from 'next';
import puppeteer from 'puppeteer';
import AWS from 'aws-sdk';
import { uuid } from 'uuidv4';
import axios from 'axios';
import FormData from 'form-data';

const engineId = 'stable-diffusion-x4-latent-upscaler'
const apiHost = process.env.API_HOST ?? 'https://api.stability.ai'
const apiKey = process.env.STABILITY_API_KEY

if (!apiKey) throw new Error('Missing Stability API key.')

async function generateImage(htmlContent: string) {
    
    const browser = await puppeteer.connect({
        browserWSEndpoint: `wss://chrome.browserless.io?token=${process.env.BLESS_TOKEN}`,
    })
    const page = await browser.newPage();
  
    await page.setContent(htmlContent);
    await page.setViewport({ width: 6732, height: 1712 });
  
    const imageBuffer = await page.screenshot({ type: 'png' });
  
    await browser.close();
  
    return imageBuffer;
}

const spacesEndpoint = new AWS.Endpoint('ams3.digitaloceanspaces.com');
const s3 = new AWS.S3({
    endpoint: spacesEndpoint,
    accessKeyId: process.env.DIGITALOCEAN_SECRET_ID,
    secretAccessKey: process.env.DIGITALOCEAN_SECRET
});

async function uploadToDigitalOcean(imageBuffer: Buffer, id: string) {
    try {
        const uploadParams = {
            Bucket: 'uniquegreetings',
            Key: id + ".png",
            Body: imageBuffer,
            ContentType: 'image/png',
            ACL: 'public-read' // Optional: Set this if you want the file to be publicly accessible
        };
        const data = await s3.upload(uploadParams).promise();
        console.log(data)
        return data["Location"]
    } catch (error) {
        console.error('Error fetching or uploading the file:', error);
        throw error;
    }
}

async function fetchAndUpload(base64img: string) {
    try {

        const uploadParams = {
            Bucket: 'uniquegreetings',
            Key: uuid() + ".png",
            Body: Buffer.from(base64img, 'base64'),
            ContentType: "image/png",
            ACL: 'public-read' // Optional: Set this if you want the file to be publicly accessible
        };

        const data = await s3.upload(uploadParams).promise();

        console.log(data)

        return data["Location"]
    } catch (error) {
        console.error('Error fetching or uploading the file:', error);
        throw error;
    }
  }

export default async function handler(
    req: NextApiRequest,
    res: NextApiResponse
  ) {
    const { order, artwork_id } = req.body;
    const formData = new FormData()
    const response = await axios.get(order.image_url, { responseType: 'arraybuffer' })
    const imageBuffer = Buffer.from(response.data, 'binary');
    formData.append('image', imageBuffer)
    formData.append('width', "1792")
    const { data } = await axios(
        `${apiHost}/v1/generation/${engineId}/image-to-image/upscale`,
        {
          method: 'POST',
          headers: {
            ...formData.getHeaders(),
            Accept: 'image/png',
            Authorization: `Bearer ${apiKey}`,
          },
          data: formData,
          responseType: 'arraybuffer'
        }
    )
    const image_url_upscaled = await fetchAndUpload(data);
    console.log("Upscaled URL: ", image_url_upscaled)
    const htmlContent = `
    <!DOCTYPE html>
    <html lang="en">
    <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/@tailwindcss/typography@0.4.1/dist/typography.min.css" rel="stylesheet" />
    </head>
    <body class="bg-white flex w-screen h-screesn" style="">
        <div id="outer-rear" style="width: 1683px; height: 1712px;" class="flex items-center justify-center space-y-8">
            <svg class="w-64 h-64" viewBox="0 0 132 132" fill="none" xmlns="http://www.w3.org/2000/svg">
            <rect width="132" height="132" fill="#FBE7DA"/>
            <path d="M26.906 50.174H26.534L26.503 50.019H26.317V49.833L26.162 49.802L26.131 49.74V49.647H25.604V49.492H25.263L25.232 49.399V49.306H25.046V49.182H24.891L24.86 49.027L24.798 48.531L24.767 47.942V47.725H24.922L24.86 47.074H25.046L24.953 46.237L24.891 45.245L24.86 45.121L25.015 45.09V44.904L24.984 44.749H25.17V44.47H25.356L25.325 44.315H25.139V44.129H25.325L25.263 43.416H25.418L25.294 42.052L25.17 40.595L25.139 40.44H25.294L25.325 40.068H25.449V39.541H25.604L25.511 38.518H25.697L25.573 36.968L25.728 36.937L25.697 36.782L25.883 36.751L25.79 35.728H25.945L25.883 34.643H26.069L26.038 34.147H26.193L26.131 33.589H26.286L26.255 33.093L26.472 33.062L26.41 32.411L26.534 32.349V32.07H26.689L26.658 31.915L26.689 31.853L26.844 31.822L26.813 31.326H27.03L26.968 30.613H27.123L27.061 29.9H27.216L27.123 29.063L27.309 29.032L27.278 28.505H27.433L27.402 28.195L27.619 28.164V28.071L27.588 27.978H27.743V27.792H27.929L27.898 27.451H28.053L27.991 26.924H28.146V26.769H28.332V26.583H28.673L28.642 26.242L29.169 26.211V26.056H30.037V25.994L30.006 25.901H30.223L30.378 25.932V26.056H30.75V26.211H30.905L30.936 26.428V26.583H31.122L31.184 26.769H31.525V26.924H31.68L31.711 27.079H31.866V27.296L31.897 27.451H32.083V27.575L32.114 27.637H32.455L32.486 27.978H32.641L32.672 28.071V28.164L32.858 28.195L32.889 28.505L33.044 28.536L33.106 28.846L33.23 28.877L33.292 29.218L33.478 29.249V29.404L33.509 29.59H33.664V29.683L33.695 29.745L33.881 29.776L33.943 30.272H34.098L34.129 30.613H34.284V30.799L34.315 30.954H34.47L34.501 31.109L34.532 31.388V31.481H34.687L34.718 31.853H34.904V31.915L34.966 32.039L35.09 32.07L35.121 32.163L35.152 32.504L35.183 32.721H35.369L35.4 33.248L35.555 33.279L35.586 33.434V33.682L35.617 33.775H35.803L35.865 34.302H35.989L36.051 34.519L36.082 34.798V35.046L36.113 35.17H36.268L36.33 35.883H36.516V36.069L36.671 36.1L36.764 36.968H36.95V37.061L36.981 37.402L37.012 37.619H37.167L37.198 37.774L37.229 38.022V38.177H37.415L37.446 38.673H37.601L37.663 39.386H37.818L37.849 39.696L37.88 40.068H38.066L38.097 40.161V40.285H38.252L38.283 40.409L38.376 41.153H38.531L38.593 41.494H38.717L38.779 41.649V41.835L38.934 41.866L38.996 42.021V42.207H39.151L39.337 44.315H39.461L39.554 44.966L39.709 45.028L39.74 45.183H39.585L39.678 46.33L39.74 47.477H39.616L39.678 48.159H39.523L39.554 48.5H39.182L39.213 48.655H38.872V48.779L38.841 48.872H38.5L38.531 49.027H37.818L37.787 48.872H37.446V48.717H37.322L37.043 48.655H36.919L36.888 48.5H36.547V48.345H36.392V48.283L36.361 48.004L36.299 47.787H36.113L36.02 46.764L36.237 46.733V46.578L36.082 46.547L35.989 46.206H35.834L35.772 45.555L35.71 44.78L35.648 44.656H35.524V44.47L35.462 44.315H35.307V44.129H34.594V44.036L34.563 43.943H31.091L30.874 43.974L30.905 44.036V44.098L29.014 44.129V44.315H28.642L28.673 44.47V44.656H28.487V44.811L28.518 44.935H28.394L28.456 45.617H28.239L28.332 46.857H28.177L28.208 46.981V47.508L28.239 47.911H28.084L28.115 48.066L28.084 48.345L28.115 48.438H27.991L28.022 48.965H27.805L27.836 49.306H27.712V49.492H27.557V49.647H27.34L27.371 49.833H27.03V50.019H26.875V50.112L26.906 50.174ZM29.851 39.913V40.068H33.695V39.913H33.881L33.757 38.673H33.571L33.54 38.177H33.385L33.323 37.464H33.137L33.106 37.216L33.075 36.906L33.044 36.751H32.889L32.827 36.069L32.641 36.007L32.61 35.728L32.455 35.697V35.666L32.424 35.48V35.356H32.269V35.17L32.083 35.139L32.052 35.015L32.021 34.86H31.866L31.835 34.488H31.649L31.587 33.961L31.432 33.93V33.775H31.246L31.215 33.589V33.434L31.029 33.403L30.998 33.279H30.316L30.347 33.434V33.589H30.161L30.192 33.775H30.006L30.037 34.302H29.882L29.913 34.643H29.696L29.758 35.17H29.603V35.356H29.448V35.418L29.479 35.759L29.51 36.007L29.324 36.069L29.355 36.41H29.2V36.751H29.014L29.107 37.805H28.952L29.014 38.673H28.859L28.89 38.828L29.045 38.859L29.076 39.386H29.231L29.293 39.758H29.479V39.913H29.851ZM47.1887 48.81H45.8247V48.686H45.5147L45.5457 48.531H45.2047L45.1737 48.376H44.8637V48.221H44.6777V47.911H44.5227V47.756H44.3677V47.601H44.1817L44.2747 44.966H44.1197V44.501H43.9647L43.9957 43.726H43.8097L43.8717 42.052L43.7167 42.021V41.804L43.6857 41.556H43.5617V40.936H43.4067V40.781H43.2517V40.006H43.0967L43.1277 39.417H42.9417V39.293L42.9727 38.983V38.797H42.7867L42.8177 38.487H42.6317V38.363L42.6627 37.743L42.6937 37.247H42.5077V37.185L42.5387 36.72V36.317H42.3837V35.542H42.5697L42.6007 34.457H42.4457V33.806L42.4147 33.682H42.2907V33.341L42.3217 33.217H42.1357L42.1667 32.597H42.3217L42.3527 32.287H42.1667L42.3217 28.133H42.4767L42.5077 27.513H42.6627L42.6937 27.358H42.8487L42.8797 26.893H43.0347V26.738H43.2207V26.583H43.4067V26.428H43.5617V26.273H43.7477V26.118H44.9567V26.273H45.0807L45.1117 26.428H45.2667V26.583H45.4217L45.4527 26.738H45.6077V26.893H45.7317V27.358H45.8867V27.451L45.9177 27.699V27.823H46.0417L46.0107 28.753H45.8867V28.815L45.8247 29.962L45.7937 31.14V31.233H45.9797L45.9177 31.295V31.357H45.7937L45.7317 31.667H45.9177L45.8867 32.907H46.0417V33.155L46.0727 33.372H46.2277L46.1967 33.992H46.3517L46.3207 34.302H46.1967L46.1657 35.387H46.2897V35.852H46.4447V36.627H46.5997V37.092H46.7547V38.146L46.8787 38.177V38.487H47.0337V39.076L47.1887 39.107V39.603L47.1577 39.882H47.3437L47.3127 40.936H47.4677L47.4987 41.246L47.6227 41.277L47.5917 42.331H47.7777L47.7467 42.548V42.827L47.7777 42.951H47.9017V43.509L47.8707 43.881H48.0567L48.0257 44.811H48.1807V45.431H48.3357V45.741H48.4907V45.896H48.6767L48.6147 47.136H48.4597V47.322L48.4287 47.632V47.756H48.2737L48.2427 47.911H48.0877L48.0567 48.221H47.9017V48.376H47.5607V48.531H47.3747V48.655L47.1887 48.686V48.81ZM68.1423 40.719L67.3673 40.75L66.6233 40.719L66.5923 40.688V40.626H65.0423V40.471H64.5773V40.347H64.2363V40.471H62.5313V40.347H62.2523V40.223H61.9113V40.161L61.8493 40.099L61.6633 40.068H61.5393V39.944H61.3843L61.3223 39.696L61.2603 39.572H61.2293L61.1983 39.417V39.293H61.1053V38.394H61.2293V37.991H61.2913L61.3533 37.929V37.867L61.5083 37.836V37.774L61.5703 37.712L61.6323 37.588L61.6943 37.526V37.464H62.0353V37.402L62.0973 37.34L62.9033 37.309H63.6163V37.185H63.8643V37.061H64.5463V37.185H64.8873V37.309H64.9493L65.0733 37.34H65.1663V37.464H66.5613V37.588H66.8093V37.712H67.0573V37.836H67.2433V37.712H67.3363L67.5223 37.526V37.464H67.7703V37.402L67.8323 37.309L67.8943 37.185L67.9563 37.123V37.061H68.1423V36.968L69.6613 36.937L69.6923 36.813H71.7693L71.8623 36.782V36.658H72.0173V36.534H72.2033V36.41H72.7303V36.534H73.0713V36.658H73.4123L73.4433 36.534H74.5593V36.596L74.6213 36.658L74.6523 36.596V36.534H75.5823V36.596L75.7063 36.72L75.7683 36.813L75.8303 36.875L75.7683 36.937H75.7063V37.185H75.6443L75.5823 37.247L75.6443 37.34L75.3963 37.402L75.4583 37.464L75.5513 37.526V37.588L75.4273 37.712V37.774L75.5823 37.929L75.6133 37.991H75.8303V38.053L75.8923 38.115H75.9543L75.9853 38.239V38.394H76.1093V38.797L76.0473 38.89L75.9853 38.952V39.045H75.7063V39.262L75.6443 39.293L75.5823 39.355L75.5203 39.448L75.4273 39.51L75.3033 39.634V39.696H75.0553V39.82H74.8073L74.7763 39.944H74.4663L74.4353 39.82H74.1873V39.696H74.0013V39.572H73.5363V39.603L73.5053 39.665L73.2263 39.696H72.9473V39.82H72.6993L72.6683 39.944H71.6143L70.4983 39.975L70.4363 40.037V40.068L69.2893 40.099L69.2273 40.223L69.1653 40.285V40.347H68.9793V40.471H68.5453V40.626H68.1733V40.688L68.1423 40.719ZM82.0412 40.471H81.0802L81.0492 40.378V40.316H79.2202V40.161H78.6002L77.8872 40.192H77.8252V40.316H76.9572V40.254L76.9262 40.192H76.8642L76.5542 40.161H76.2132V40.037H76.1512L75.9342 40.006H75.8412V39.882H75.0972V39.727H74.9422L74.9112 39.665L74.8492 39.572H74.8182V39.293H74.7252L74.6632 39.2L74.5702 39.138L74.5082 39.045L74.4152 38.983H74.3532V38.704L74.2292 38.673V37.96H74.2912L74.3532 37.805V37.681L74.4152 37.65L74.5082 37.588L74.5702 37.495L74.6632 37.433L74.7252 37.34L74.8182 37.278L74.8802 37.216L74.9112 37.123L74.9732 37.061H75.0352V36.906H75.3452V36.751H75.5312V36.689L75.5932 36.627L75.6242 36.534L75.6552 36.472H75.9342V36.317H76.8642V36.472H77.1742L77.1432 36.596H77.2362L77.9182 36.627H78.4762V36.751H78.8792V36.627H82.6302V36.472H83.1262V36.317H83.2502V36.472H84.4592V36.596L84.5212 36.627H85.0482V36.472H85.6682V36.317H86.2882V36.441H86.3812L86.6602 36.472H86.8772V36.596H86.9702L87.1252 36.627H87.1872V36.751L87.3732 36.782L87.4042 36.906L87.9932 36.937V37.061H88.2102V37.216H88.5202V37.278L88.4892 37.371H88.5822L88.6442 37.433V37.495H88.7992V38.673L88.6442 38.704V39.107H88.5202L88.4892 39.417H88.4272L88.2722 39.572H88.2102V39.727H88.0552V39.882H87.9002V40.006H87.7142V40.161H87.6212V40.316H87.4042V40.44L87.1562 40.471H86.8772V40.316H86.5982V40.161H86.3812V40.099L86.3192 40.037L85.9472 40.006L85.5752 40.037H85.4822V40.161H83.9632V40.006H83.7772V40.161H83.2812V40.099L83.2502 40.037H82.4442V40.161L82.2582 40.192V40.316L82.0412 40.347V40.471ZM98.4511 39.913V40.037H97.8931V39.975L97.8621 39.913L97.6141 39.882L97.3351 39.913L97.2731 40.037L97.2111 39.975V39.913L96.5601 39.882V39.758H96.4671L95.5371 39.727H94.6381V39.572H94.4211V39.448H94.3281L93.7391 39.417H93.2121V39.355L93.1811 39.293H91.8481V39.417L91.5071 39.448V39.572L90.8251 39.603V39.727H90.2671V39.572H89.7401V39.51L89.7091 39.448L88.5931 39.417V39.262H88.2831V39.2L88.2211 39.107L88.1591 39.045L88.1281 38.952L88.0351 38.89V38.828L87.8491 38.797V38.735L87.8181 38.673H87.7251L87.6941 38.58L87.6011 38.487H87.5391L87.4771 38.177H87.3841L87.3531 38.022V37.588L87.5081 37.557V37.433L87.6011 37.278L87.6631 37.123L87.6941 36.968H87.8181V36.72L87.8491 36.503H87.9111L87.9731 36.41V36.348L88.0661 36.317L88.1591 36.255V36.193L88.4381 36.162V36.1L88.5001 36.038H88.5931V35.945L88.6861 35.883H88.7481V35.79L88.8101 35.697L88.8721 35.635V35.573H89.8331L89.8641 35.635V35.697H90.2981L90.7631 35.728L90.8251 35.79V35.852H90.8871L91.2901 35.883H91.6311V36.007L91.7241 36.038H91.9411V35.883H92.7161L93.5221 35.852L93.5841 35.79V35.728H93.6771L94.0801 35.697L94.5141 35.728L94.5761 35.79V35.852L94.7931 35.883V36.007H94.8861L95.1031 36.038H95.2271V36.162H95.3201L95.7231 36.193H96.0331V36.317H96.6841V36.193H97.2421V36.317L98.7301 36.348L98.7611 36.503H98.8541L98.8851 36.41V36.317H101.396V36.193H101.83V36.317H102.047V36.472H102.109L102.233 36.658L102.295 36.72L102.326 36.813H102.388L102.419 37.557V38.332L102.264 38.363V38.456L102.233 38.611L102.171 38.673L102.14 38.735V38.797H102.016V38.952H101.892V39.107H101.799V39.262H101.458V39.417H101.117V39.572H100.125L100.094 39.727L99.6601 39.758V39.882L98.4511 39.913Z" fill="#4285BA"/>
            <path d="M33.447 77.81H32.362V77.624H31.277L31.308 77.469H30.936V77.283H30.254L30.285 77.097H29.944L29.913 77.004V76.942L29.572 76.911L29.603 76.725H29.417V76.57H29.076L29.107 76.384H28.735L28.766 76.012H28.58V75.826H28.394L28.425 75.671H28.27V75.485L28.084 75.454L28.115 75.33H27.929L27.96 74.958H27.774L27.805 74.586H27.619V74.431H27.464L27.495 74.307V74.214H27.309V73.687H27.154L27.185 73.532H26.999L27.03 73.16H26.844V72.974H26.658L26.689 72.788H26.534L26.503 72.633L26.534 72.447L26.41 72.416L26.379 72.354V72.261H26.007L26.038 72.168V72.075H25.883V71.982L25.914 71.796L25.883 71.734H25.728L25.759 71.393L25.728 71.362H25.573V71.176H25.387L25.418 70.835H25.232L25.263 70.494H25.108L25.17 69.936H24.953L24.984 69.378H24.86V69.037L24.891 68.696H24.705L24.767 67.952H24.612L24.643 67.611H24.457L24.488 67.487V67.239H24.302L24.333 67.053H24.178L24.24 66.309L24.302 65.41V65.255H24.116L24.209 64.232L24.054 64.201L24.085 63.86L24.116 63.488H23.93L23.961 63.116H24.147L24.333 61.163H24.488L24.519 60.636H24.705L24.736 60.481L24.767 60.233L24.798 60.109L24.953 60.078V59.923L24.984 59.737L25.17 59.706V59.551H25.356L25.387 59.396H25.542L25.573 59.024H25.759L25.79 58.652H25.945L26.007 58.125L26.193 58.094L26.224 57.753H26.379L26.41 57.412L26.782 57.381L26.813 57.226L27.185 57.195V57.04L27.34 57.009L27.371 56.854H27.557L27.588 56.513L27.805 56.482V56.327H27.898L27.96 56.296L27.991 56.11V55.955H28.146L28.177 55.769H28.735V55.583H29.448L29.479 55.459L30.037 55.428V55.242H30.409L30.564 55.211L30.595 55.056H31.835V54.87H32.734V55.056H34.346L34.315 55.211L34.656 55.273L34.687 55.428L34.842 55.459V55.583L35.183 55.614V55.769L35.369 55.8V55.862L35.338 56.017V56.141H35.493V56.482L35.648 56.513L35.586 57.009L35.772 57.04L35.741 57.412H35.927L35.896 57.722L35.865 58.156L35.834 58.28H35.679L35.648 58.404V58.683L35.586 58.838H35.431L35.4 59.148L35.245 59.179L35.214 59.365H34.687L34.501 59.334V59.179H33.788L33.819 59.024H33.292V58.838H32.92L32.951 58.652H31.897L31.866 58.838H31.494V59.024H31.153L31.122 59.148L30.595 59.179L30.564 59.272V59.396H30.223L30.192 59.551H30.006V59.706L29.665 59.737L29.634 59.923H29.417L29.386 60.419H29.231L29.2 60.543V60.636H29.014V60.791H28.828L28.797 60.977H28.642V61.163L28.58 61.318H28.425L28.363 61.876H28.208L28.053 63.488H28.208L27.991 65.813H28.208L28.146 66.712H28.301L28.27 67.053H28.456L28.425 67.239H28.611V67.425H28.766L28.735 67.797H28.921V68.169H29.076L29.045 68.324H29.231L29.2 68.696H29.386L29.355 69.223H29.51L29.479 69.595H29.665L29.634 69.75H29.789L29.758 70.091H29.975V70.308H30.161L30.13 70.649H30.285L30.254 70.835H30.44V70.928L30.471 70.99L30.626 71.021L30.595 71.207H30.781V71.393H30.936L30.905 71.548H31.091L31.06 72.075H31.246V72.168L31.215 72.261H31.37L31.339 72.633H31.525V72.788H31.711L31.68 72.912V72.974H32.052V73.16H32.579L32.548 73.346H32.92L32.951 73.16H33.478L33.447 73.346H33.974V73.532H34.718V73.346H35.431L35.462 73.16H35.803V73.005L35.927 72.974H36.175L36.206 72.788H36.547V72.633H37.105L37.136 72.54V72.447H37.477V72.261H38.004L38.066 72.075H38.407V71.889H38.593L38.624 71.734H38.81V71.548H39.151L39.182 71.393H39.337L39.616 71.362H39.74V71.207H40.236L40.267 71.021H40.67L40.639 71.207H40.794L40.825 71.269V71.362H40.98L40.949 71.734L40.918 72.075H41.073L41.011 72.633H41.197L41.135 73.346H40.949L40.918 73.687H40.763V73.873H40.577L40.515 74.431H40.36L40.329 74.772H39.957V74.865L39.926 74.958H39.585L39.554 75.144H39.399V75.33H39.213L39.182 75.392V75.454L38.996 75.485V75.671H38.624L38.593 75.826H38.438V76.012H38.066L38.035 76.198L37.663 76.229V76.384H37.136L37.105 76.477V76.539L36.764 76.57L36.733 76.663V76.725H36.392L36.361 76.911H36.175V77.097H35.648L35.617 77.252L34.904 77.283V77.469H34.377L34.346 77.624H33.447V77.81ZM42.389 78.988H41.893L41.738 78.957V78.833H41.614L41.335 78.802H41.211L41.18 78.647H41.025V78.492H40.87L40.839 78.151H40.684L40.653 78.027L40.622 77.748L40.591 77.624H40.436L40.312 75.95H40.467V75.609H40.622L40.591 75.299H40.746L40.684 74.617L40.839 74.586V74.245H40.994L40.901 73.439L41.056 73.408L41.087 73.346V73.253H40.901L40.87 73.098L41.025 73.067V72.571H41.18L41.087 71.641L41.025 70.711H41.211L41.18 70.618V70.556H41.335L41.273 69.719L41.18 68.851H41.366L41.273 67.704L41.397 67.673L41.366 66.836H41.521L41.459 66.34H41.614L41.552 65.658H41.738L41.707 65.162H41.893L41.831 64.48H41.986L41.955 63.984L42.11 63.953L42.079 63.798L42.11 63.643L42.265 63.612L42.234 63.302L42.203 62.961H42.358V62.62H42.513L42.482 62.434H42.637V61.938H42.792V61.783H42.947L42.885 61.287L43.04 61.256V60.76H43.164L43.195 60.419L43.319 60.45L43.288 60.264H43.474L43.443 59.768L43.598 59.737L43.567 59.582L43.598 59.427H43.722V59.086H43.877L43.846 58.714L43.784 58.218L43.815 58.063H43.97L43.939 57.753H44.094V57.567L44.249 57.536L44.218 57.443L44.249 57.288V57.226H44.404L44.342 56.544H44.528L44.497 56.389H44.621V55.862H44.776L44.745 55.707H44.931V55.552H45.086L45.055 55.211H45.396L45.365 55.025H45.551V54.839H45.675L45.923 54.87H46.047V55.025H46.543L46.574 55.211H46.915V55.366H47.07L47.101 55.428V55.521L47.132 55.552H47.442V55.614L47.473 55.707H47.597L47.659 55.862L47.969 55.893L48.031 56.389H48.186L48.217 56.699L48.403 56.73L48.434 57.071H48.589L48.62 57.226H48.775V57.381L48.837 57.536L48.992 57.567V57.722L49.147 57.753L49.178 57.877L49.333 57.908L49.395 58.404H49.55L49.581 58.59H49.767L49.798 59.086H49.953V59.241L49.984 59.396L50.17 59.427L50.201 59.923H50.356L50.387 60.264H50.573L50.604 60.419H50.759L50.79 60.915L50.945 60.946V61.039L51.007 61.287L51.038 61.442H51.193L51.224 62.093L51.379 62.124L51.472 62.775L51.627 62.806L51.72 63.643H51.875V63.798L51.937 63.984H52.061V64.077L52.123 64.387L52.154 64.635H52.309L52.34 65.162H52.495L52.526 65.472H52.712L52.743 65.968L52.898 65.999L52.929 66.216L52.96 66.526L52.991 66.65H53.115L53.146 66.774L53.177 67.053L53.208 67.177H53.363L53.425 67.859H53.58L53.642 68.169L53.673 68.51L53.797 68.541L53.828 68.665L53.859 68.913V69.037H54.014V69.192L54.076 69.378H54.231L54.324 70.556H54.479L54.51 70.711H54.665L54.696 70.866L54.727 71.052V71.238L54.758 71.393H54.913L54.975 72.075H55.161L55.192 72.416H55.347V72.571H55.502L55.533 72.726L55.688 72.757L55.719 72.912H55.905L55.998 74.09H56.153L56.215 74.586H56.06V74.927H55.905L55.936 75.268L55.75 75.299V75.454H55.595L55.626 75.609H55.471V75.764H55.285L55.316 75.95H55.006L54.975 76.043V76.136H54.82V76.291H54.665V76.632H54.355V76.787H53.673V76.632H53.301L53.177 76.601V76.446H53.022L52.96 76.291V76.136H52.805L52.774 75.764H52.588L52.557 75.454H52.402L52.371 75.113H52.216L52.185 74.772H51.999V74.586H51.658L51.627 74.245H51.813L51.72 73.253H51.534L51.472 72.726H51.317V72.478L51.286 72.23H51.131V72.137L51.069 71.982V71.92L50.914 71.889V71.734H49.395V71.889H49.271L48.744 71.92H48.372L48.403 72.075H47.907V72.23H47.38V72.385H46.419L45.365 72.416H45.241V72.54L45.086 72.571H44.218V72.664L44.187 72.726H44.063L44.094 73.253H43.939L43.97 73.749H43.815L43.846 73.873L43.908 75.144L44.001 76.291H43.877V76.415L43.908 76.911L43.939 77.283H43.784L43.815 77.624H43.629L43.66 77.965H43.505V78.151H43.35V78.306H43.195L43.226 78.647H42.73L42.699 78.74L42.73 78.833H42.42V78.895L42.389 78.988ZM47.721 68.386L47.752 68.541H48.093L48.062 68.448V68.355H49.426V68.169H49.581L49.55 68.014H49.736L49.674 67.673H49.519V67.518L49.488 67.27L49.457 67.177H49.333L49.302 66.867L49.271 66.464L49.209 66.34H49.054V66.185L49.24 66.154L49.209 65.999H49.023L48.992 65.472H48.837L48.806 65.162H48.651L48.589 64.635H48.434L48.403 64.542L48.372 64.48H48.217L48.186 63.953H48.031L47.969 63.457H47.814L47.783 63.085L47.721 62.651L47.659 62.62H47.597L47.566 62.527L47.535 62.465L47.38 62.434L47.318 62.093H47.163V61.938H46.481L46.512 62.434H46.357L46.388 62.62H46.233V62.961H46.109L46.078 63.116L46.109 63.271H45.954V63.457H45.768L45.799 63.798H45.644V63.953L45.489 63.984V64.139H45.334L45.365 64.48H45.21L45.241 64.976H45.086V65.286L44.931 65.317V65.658H44.776L44.807 65.999H44.652L44.683 66.495L44.528 66.526L44.559 66.836L44.59 67.177H44.435L44.497 67.859H44.652V68.014H44.838L44.869 68.169H45.024V68.355H47.597L47.721 68.386ZM63.3659 79.267H61.6609V79.205L61.6299 79.143H61.4749V78.957H61.2579V78.678L61.0409 78.647V78.337H60.8239V78.027H60.5759V77.407H60.3899V77.283L60.3589 76.446V75.702H60.2349V75.485L60.2039 75.144V75.051H60.0799L60.0489 74.431H59.8939V72.416H59.7699V72.323L59.7389 71.145V70.06H59.5839V67.859H59.4599V66.433L59.4289 66.123V65.999H59.2739V64.449H59.1189V63.054H58.9639V62.558H58.8089V61.969L58.6539 61.938V60.233L58.4989 60.202V59.768H58.3439V58.373H58.4989V58.187H58.6539V58.032H58.8089V57.877H59.1499V57.722H59.4909V57.598L59.8009 57.567V57.412H59.9869V57.102H60.1729V56.947H60.3279V56.792H60.4829V56.637H60.6379V56.482H60.8549V56.327H61.0099V56.172L61.3509 56.141V55.831H61.4749L61.5059 55.769V55.707H61.8469V55.552H62.1259L62.1569 55.459V55.397L62.3429 55.366V55.211H62.4979V55.087H62.6529V54.932L62.9939 54.901V54.777H63.3349V54.591H63.6449V54.436H63.9859V54.281H64.6679V54.157L65.1639 54.126V53.971H66.3419V53.816H67.4889V53.971H68.4809V54.126L69.0079 54.157V54.281H69.3799L69.4729 54.312L69.5039 54.436H69.9999V54.591L70.3409 54.622V54.777H70.5269V54.901L70.8369 54.932V55.056L71.1779 55.087V55.242L71.2089 55.397H71.3329V55.521L71.5189 55.552V55.707H71.6739V55.831L71.8289 55.862V56.017H72.0149V56.141L72.1699 56.172V56.327H72.3249L72.3559 56.637H72.5109V56.792H72.6659V57.102L72.6969 57.412H72.8209L72.8519 57.722H73.0069V58.032H73.1619V58.652L73.3169 58.683V61.318H73.1619V61.628H73.0999L73.0379 61.659L73.0069 61.814V61.938H72.8829L72.8519 62.248H72.7279L72.6969 62.558L72.5419 62.589V62.868L72.4179 62.899L72.3869 63.333L72.2319 63.364V63.488H71.9219V63.643L71.6119 63.674V63.798L71.4569 63.829V63.984H71.3019V64.108L71.1469 64.139V64.201L71.1159 64.263H70.9919V64.418L70.8369 64.449V64.573L70.6819 64.604V64.728L70.3719 64.759V64.883L70.2169 64.914V65.069H70.0619V65.224H69.9069L69.8759 65.379H69.7519V65.472L69.7209 65.534H69.5969V65.689H69.4419V65.844H69.2869V65.999H69.1319L69.1009 66.154H68.9769L68.9459 66.557V66.929L69.1009 66.96L69.1319 67.239L69.2869 67.27V67.425H69.5969V67.549L69.7209 67.58V67.704L69.8759 67.735L69.9069 67.859L70.2169 67.89V68.014H70.2789L70.3409 68.045L70.3719 68.2V68.324L70.5269 68.355V68.665H70.6819V68.82H70.8369V68.975H70.9919V69.13H71.1469V69.285H71.3019V69.595H71.4569V69.75H71.6119V69.905H71.7669V70.215H71.9219V70.525H72.0769V70.618L72.1079 70.68L72.1699 70.711H72.2319V70.99H72.3869L72.4179 71.3L72.5419 71.331L72.5729 71.455L72.6969 71.486V71.641L72.7279 71.765H72.8519L72.8829 72.106H73.0069V72.23L73.1619 72.261V72.54H73.3169V72.881H73.4719L73.5029 72.974V73.036H73.6269L73.6579 73.346H73.7819L73.8129 73.656H73.9369L73.9679 73.966H74.1229V74.121H74.2469L74.2779 74.431H74.4019L74.4329 74.555V75.051H74.5569L74.5879 75.423V75.919L74.5569 75.981H74.4329V76.167H74.2779V76.229L74.2469 76.291L74.1229 76.322L74.0919 76.632H73.9369V76.756L73.8129 76.787L73.7819 76.849V76.942H73.4409V77.097H72.9139V77.252H72.2009V77.407H71.4569V77.252H70.9919V77.097H70.8369V76.942H70.6819V76.787H70.5269V76.632H70.4029L70.3719 76.477H70.2479L70.2169 76.353V76.167H70.0619V75.857H69.9069V75.702L69.7519 75.671V75.547H69.5969V75.237L69.4419 75.206V74.896H69.3179V74.772L69.1629 74.741V74.276H69.0389V74.121H68.9149L68.8839 73.811H68.7909V73.656H68.6359V73.346H68.5119V73.16H68.3569V73.005H68.2639L68.2329 72.726H68.1089V72.571L67.9849 72.54L67.9539 72.416L67.8299 72.385V72.261H67.7059V71.765H67.5819V71.455H67.4579V71.393L67.4269 71.238V71.145H67.3029V70.99H67.1789V70.835H67.0549V70.68H66.8999V70.525H66.7759V70.37H66.6519V70.215H66.4969V69.905H66.2489V69.75H66.1249V69.595H65.9699V69.44H65.8459V69.285H65.5979V69.13H65.4429V68.975H65.1949V68.82H65.0709V68.665H64.9159V68.51L64.6679 68.479L64.6369 68.417V68.324H64.5439V68.262L64.5129 68.2L64.1099 68.169V68.045L63.9859 68.014H63.8309L63.7999 68.107V68.169H63.6759L63.6449 68.324V68.51H63.4899V69.285L63.5209 70.06L63.6449 70.091V72.106H63.7999V73.563L63.8309 73.656H63.9549V74.431H64.1099V74.679L64.1409 74.896L64.2649 74.927V75.857H64.4509V76.167H64.5749V77.841L64.4509 77.872L64.4199 78.182H64.2959L64.2649 78.306V78.492H64.1099V78.647H63.9549V78.802H63.7999V78.957H63.5829V79.112L63.3659 79.143V79.267ZM63.7999 63.829V63.984H64.8539V63.829H65.1639L65.5359 63.798H65.6599V63.674L66.3109 63.643V63.519L66.4349 63.488V63.364H66.4659L66.5279 63.333L66.5589 63.271V63.209L66.6829 63.178V63.054L66.9619 63.023V62.744L67.0859 62.713V62.434H67.3339V62.279L67.6129 62.248V62.093H67.7369L67.7679 62.031V61.938H67.8919V61.783H68.1399V61.628H68.2639V61.318H68.4189V61.163H68.6669V60.853H68.7909V60.698H68.9769V60.388H69.1319V59.272H68.9769V58.993L68.8219 58.962L68.7909 58.652H68.6669V58.497H68.5119V58.218L68.3879 58.187V58.125L68.3569 58.032H67.9539V57.877H67.6749V57.722H67.4269V57.567H67.1479V57.412H66.3419V57.536L65.8149 57.567H65.2569L65.2259 57.66V57.722H64.8539V57.877H64.5749V58.032L64.2959 58.063V58.187H64.2029L64.1719 58.28V58.342H64.0479V58.528L63.9239 58.497L63.8929 58.59V58.652H63.7689V58.807H63.6449V58.993H63.4899V59.117L63.3659 59.148V59.272H63.2419V59.427H63.0869V59.613H62.9629V59.923H62.8389V60.233H62.6839V60.388H62.5599V61.473H62.6839L62.7149 61.628V61.938L62.8699 61.969V62.558L63.0249 62.589V63.178L63.1799 63.209V63.488H63.3349V63.674H63.4899V63.829H63.7999ZM81.1497 78.678H80.3127V78.554H79.9717V78.368H79.7857V78.213H79.4447V78.058H79.2897V77.872H79.1037V77.717H78.9177V77.376H78.7627V77.221H78.5767V77.066L78.4217 77.035V76.911L78.2357 76.88V76.725H78.0807V76.57H77.8637L77.8947 76.229H78.0807V75.764H78.2357V74.927H78.3907V74.431H78.2357V73.439H78.0807V71.982H77.8637V71.145H77.7087V70.339H77.5537V69.843H77.7087V69.347H77.5537V67.239H77.3987V65.441L77.2127 65.41L77.1817 63.271H77.0267V61.969H76.8407V61.473H76.7167V61.411L76.6857 61.318H76.4997V60.822H76.3447V60.481H76.1587V60.326H75.9727V60.171H75.8177V59.83H75.6627V58.373H75.8177V58.218L75.9727 58.187V57.877H76.1587V57.722H76.3447V57.536H76.6857V57.381H77.0267V57.226H77.1817V57.04H77.5537V56.885H78.2357V56.73L78.5767 56.699V56.575H78.9177V56.389H79.4447V56.234H79.7857V56.079H80.1267V55.924H80.6537V55.738H80.9637L80.9947 55.645V55.583H82.0487V55.428L82.7307 55.397V55.273L82.8547 55.242H83.5677V55.087H85.0867L85.1487 55.18V55.242L85.3037 55.273V55.397L85.8307 55.428V55.583H86.2957L86.3267 55.738H86.5127V55.924H86.6677V56.048L87.0087 56.079V56.234H87.1947V56.389L87.5357 56.42V56.575H87.6907V56.885H88.0317V56.978L88.0627 57.04H88.2177V57.226H88.4037V57.536H88.5587V57.691L88.7447 57.722V57.877H88.8997V58.032H89.0857V58.125L89.1167 58.187L89.4267 58.218V58.373H89.5817V58.683H89.7677V58.838H89.9537V59.179H90.1087V59.52H90.2947V59.675H90.4807V59.83H90.6357V60.171H90.7907V60.481H90.9457L91.0077 60.729V60.977H91.0697L91.1317 61.008L91.1627 61.504V61.969H91.3177V62.496L91.3487 62.62H91.4727V63.426L91.6897 63.457V64.108H91.8447V64.573L91.9997 64.604V64.914H92.1547V65.038L92.1857 65.286V65.41H92.3717V66.061H92.5267V67.363L92.6817 67.394V68.355L92.5267 68.386V68.696H92.3717V69.192H92.1857L92.1547 69.502L91.9997 69.533V69.998H91.8447V70.494L91.6897 70.525L91.6587 70.835H91.4727V71.331H91.3177V71.641L91.1627 71.672V71.982H91.0077V72.137H90.7907V72.447L90.4807 72.478L90.4497 72.54V72.633H90.2947L90.2637 73.129H90.1087V73.439L89.9537 73.47V73.594L89.7987 73.625L89.7677 73.687V73.78H89.4267V73.935H89.2717L89.2407 74.09L89.0857 74.121V74.586H88.8997V74.772H88.7137V75.268H88.5897L88.5587 75.578H88.4037V75.764H88.2177V75.919H88.0317V76.229H87.9077V76.415H87.5357V76.57H87.3497V76.725H87.1947V77.035L87.0087 77.066V77.221H86.8537V77.531L86.6987 77.562L86.6677 77.872L86.5127 77.903V78.027L86.1407 78.058V78.213H85.9857V78.368H85.6447V78.554H85.0867V78.678H83.9397V78.554H83.0407V78.368H82.7307V78.554H81.1497V78.678ZM83.2267 75.175L83.2577 75.268H83.4127L83.5677 75.237V75.113L83.9087 75.082L83.9397 75.02V74.927H84.0947V74.772H84.2497V74.617L84.4047 74.586V74.462L84.5907 74.431L84.6217 74.276L84.7767 74.245V74.121L84.9317 74.09L84.9627 73.935H85.1487V73.78H85.3037V73.625H85.4587V73.47H85.6447V73.284H85.8307V73.129H85.9857V72.974L86.0167 72.788H86.1717V72.633H86.3267V72.478H86.5127V72.137H86.6677V71.796H86.8537V71.672L86.9777 71.641L87.0087 71.331H87.1947V71.176L87.3497 71.145L87.3807 70.99H87.5357V70.494H87.6907V70.153H87.9077V69.998H88.0317V69.843H88.2177V69.347H88.4037L88.4347 69.037H88.5587V68.913L88.5897 68.665V68.541H88.7137V66.712H88.5897V66.526L88.5587 66.216V66.061H88.4037V65.534L88.3417 65.41H88.2177V64.294L88.0317 64.263V63.798H87.9077L87.8767 62.775H87.6907V62.465H87.5357V62.124H87.3807L87.3497 61.814L87.1947 61.783V61.659L87.0087 61.628V61.318H86.6677V61.008L86.5127 60.977V60.822H86.3267V60.667H86.1717V60.512L86.0167 60.481L85.9857 60.326H85.8307V60.171H85.6447V60.016H85.3347L85.3037 59.675H85.1487L85.0867 59.52L84.7767 59.489V59.334H84.4047V59.179H83.9397V59.117L83.9087 59.024H82.8857V59.179H82.7307V59.334H82.3587V59.489L81.3357 59.52V59.675H81.1497V59.83H80.9947L80.9637 60.171H80.8087V61.318H80.6537V62.124L80.8087 62.155V62.775H80.9637V62.899L80.9947 63.581V64.108H81.1187L81.1497 64.232V64.759H81.3357V67.394H81.4907L81.5217 67.89V68.355L81.6457 68.386L81.6767 69.192V69.998H82.0487V70.494L82.2037 70.525V70.835H82.0487V71.455L81.8937 71.486L81.8317 71.796L82.0177 71.827L82.0487 72.974H82.1727L82.2037 73.098V73.47H82.3587V74.121H82.5447V74.586H82.7307V74.772H82.8857V75.113H83.2267V75.175ZM33.447 106.81H32.362V106.624H31.277L31.308 106.469H30.936V106.283H30.254L30.285 106.097H29.944L29.913 106.004V105.942L29.572 105.911L29.603 105.725H29.417V105.57H29.076L29.107 105.384H28.735L28.766 105.012H28.58V104.826H28.394L28.425 104.671H28.27V104.485L28.084 104.454L28.115 104.33H27.929L27.96 103.958H27.774L27.805 103.586H27.619V103.431H27.464L27.495 103.307V103.214H27.309V102.687H27.154L27.185 102.532H26.999L27.03 102.16H26.844V101.974H26.658L26.689 101.788H26.534L26.503 101.633L26.534 101.447L26.41 101.416L26.379 101.354V101.261H26.007L26.038 101.168V101.075H25.883V100.982L25.914 100.796L25.883 100.734H25.728L25.759 100.393L25.728 100.362H25.573V100.176H25.387L25.418 99.835H25.232L25.263 99.494H25.108L25.17 98.936H24.953L24.984 98.378H24.86V98.037L24.891 97.696H24.705L24.767 96.952H24.612L24.643 96.611H24.457L24.488 96.487V96.239H24.302L24.333 96.053H24.178L24.24 95.309L24.302 94.41V94.255H24.116L24.209 93.232L24.054 93.201L24.085 92.86L24.116 92.488H23.93L23.961 92.116H24.147L24.333 90.163H24.488L24.519 89.636H24.705L24.736 89.481L24.767 89.233L24.798 89.109L24.953 89.078V88.923L24.984 88.737L25.17 88.706V88.551H25.356L25.387 88.396H25.542L25.573 88.024H25.759L25.79 87.652H25.945L26.007 87.125L26.193 87.094L26.224 86.753H26.379L26.41 86.412L26.782 86.381L26.813 86.226L27.185 86.195V86.04L27.34 86.009L27.371 85.854H27.557L27.588 85.513L27.805 85.482V85.327H27.898L27.96 85.296L27.991 85.11V84.955H28.146L28.177 84.769H28.735V84.583H29.448L29.479 84.459L30.037 84.428V84.242H30.409L30.564 84.211L30.595 84.056H31.835V83.87H32.734V84.056H34.346L34.315 84.211L34.656 84.273L34.687 84.428L34.842 84.459V84.583L35.183 84.614V84.769L35.369 84.8V84.862L35.338 85.017V85.141H35.493V85.482L35.648 85.513L35.586 86.009L35.772 86.04L35.741 86.412H35.927L35.896 86.722L35.865 87.156L35.834 87.28H35.679L35.648 87.404V87.683L35.586 87.838H35.431L35.4 88.148L35.245 88.179L35.214 88.365H34.687L34.501 88.334V88.179H33.788L33.819 88.024H33.292V87.838H32.92L32.951 87.652H31.897L31.866 87.838H31.494V88.024H31.153L31.122 88.148L30.595 88.179L30.564 88.272V88.396H30.223L30.192 88.551H30.006V88.706L29.665 88.737L29.634 88.923H29.417L29.386 89.419H29.231L29.2 89.543V89.636H29.014V89.791H28.828L28.797 89.977H28.642V90.163L28.58 90.318H28.425L28.363 90.876H28.208L28.053 92.488H28.208L27.991 94.813H28.208L28.146 95.712H28.301L28.27 96.053H28.456L28.425 96.239H28.611V96.425H28.766L28.735 96.797H28.921V97.169H29.076L29.045 97.324H29.231L29.2 97.696H29.386L29.355 98.223H29.51L29.479 98.595H29.665L29.634 98.75H29.789L29.758 99.091H29.975V99.308H30.161L30.13 99.649H30.285L30.254 99.835H30.44V99.928L30.471 99.99L30.626 100.021L30.595 100.207H30.781V100.393H30.936L30.905 100.548H31.091L31.06 101.075H31.246V101.168L31.215 101.261H31.37L31.339 101.633H31.525V101.788H31.711L31.68 101.912V101.974H32.052V102.16H32.579L32.548 102.346H32.92L32.951 102.16H33.478L33.447 102.346H33.974V102.532H34.718V102.346H35.431L35.462 102.16H35.803V102.005L35.927 101.974H36.175L36.206 101.788H36.547V101.633H37.105L37.136 101.54V101.447H37.477V101.261H38.004L38.066 101.075H38.407V100.889H38.593L38.624 100.734H38.81V100.548H39.151L39.182 100.393H39.337L39.616 100.362H39.74V100.207H40.236L40.267 100.021H40.67L40.639 100.207H40.794L40.825 100.269V100.362H40.98L40.949 100.734L40.918 101.075H41.073L41.011 101.633H41.197L41.135 102.346H40.949L40.918 102.687H40.763V102.873H40.577L40.515 103.431H40.36L40.329 103.772H39.957V103.865L39.926 103.958H39.585L39.554 104.144H39.399V104.33H39.213L39.182 104.392V104.454L38.996 104.485V104.671H38.624L38.593 104.826H38.438V105.012H38.066L38.035 105.198L37.663 105.229V105.384H37.136L37.105 105.477V105.539L36.764 105.57L36.733 105.663V105.725H36.392L36.361 105.911H36.175V106.097H35.648L35.617 106.252L34.904 106.283V106.469H34.377L34.346 106.624H33.447V106.81ZM44.187 107.275H43.815V107.12L43.412 107.089V106.965H43.226L43.195 106.81L42.854 106.779V106.469H42.637V106.035L42.482 106.004V105.694H42.296V104.485H42.141V103.834H41.924V103.679L41.955 103.524H42.141V102.594L41.924 102.563V101.664H41.8V101.137L41.769 101.044H41.614V100.92L41.583 100.362V99.928H41.428V98.688H41.273V97.448H41.428V96.022H41.273V95.929L41.242 95.092V94.348H41.087V93.883L41.242 93.852V93.263L41.118 93.232L41.087 92.457H40.901V90.752H40.746V89.512H40.56V89.202H40.746V87.962H40.901V87.466H41.087V87.187H41.242V87.032H41.428V86.877H41.583V86.722L41.831 86.691V86.567H41.955V86.474L41.986 86.381H42.172V86.226H42.513V86.071H42.854V85.761H43.009V85.637L43.195 85.606L43.226 85.296H43.412V85.141H43.753V85.048L43.784 84.986H44.094V84.862L44.249 84.831V84.676H44.435V84.552L44.807 84.521V84.366H45.303V84.211H45.644V84.056H45.985V83.901H46.357V83.746H48.279L48.31 83.839V83.901H48.961L48.992 83.994V84.056H49.333L49.364 84.211H49.519L49.55 84.366L49.891 84.397V84.521L50.232 84.552V84.676H50.418V84.831L50.573 84.862V84.986H50.945V85.141L51.286 85.172V85.296H51.472V85.451H51.813V85.606H51.968L51.999 85.761L52.34 85.792V85.916H52.526V86.009L52.557 86.071H52.867L52.898 86.164V86.226L53.022 86.257V86.381H53.208V86.536H53.363L53.425 86.691L53.549 86.722L53.58 86.846L53.766 86.877L53.797 87.001L54.107 87.032V87.342H54.262V87.466L54.479 87.497V87.621L54.603 87.652L54.634 87.776L54.789 87.807V87.869L54.82 87.931L54.882 87.962H54.944V88.086H55.161L55.192 88.272V88.427H55.347V88.582H55.502V88.706L55.657 88.737L55.688 88.892H55.843V88.954L55.874 89.171V89.357H56.029V90.752H55.967L55.874 90.783V90.907L55.843 91.031L55.688 91.062L55.657 91.682H55.533L55.502 91.837H55.347L55.316 91.992H55.192V92.147L55.161 92.302L54.975 92.333V92.457H54.851V92.922H54.665L54.634 93.077H54.51L54.479 93.232L54.293 93.263V93.387H54.169L54.138 93.697L53.952 93.728V93.852H53.828L53.797 94.193H53.611V94.348H53.27V94.503H53.115V94.813H52.929V94.968H52.774V95.092H52.433V95.247H52.247V95.402H52.123V95.557H51.782L51.751 95.619V95.743H51.565V95.898H51.379V96.053H51.224V96.208H51.038V96.673H51.224V96.828H51.379V96.983H51.565V97.138H51.751L51.782 97.479H51.906V97.603L52.092 97.634V97.758H52.247V97.851L52.278 97.913H52.371L52.433 97.944V98.068H52.774V98.223H53.115V98.378H53.27V98.533H53.456V98.843H53.611V98.998H53.797V99.153H54.138V99.308H54.293V99.463H54.479V99.556L54.51 99.649H54.634V99.773L54.851 99.804V99.928H54.975V100.114H55.192V100.269H55.347V100.579H55.533V100.734H55.595V100.858L55.688 100.889V101.044H55.874V101.199H56.029V101.509H56.37V101.664H56.556V101.819H56.711V101.974H57.021L57.083 102.439H57.238V102.594H57.424V103.059L57.579 103.09V103.369H57.765V103.679H57.92V103.834H58.106V104.144H58.261V105.57H58.106V105.694H57.92V105.849H57.765V106.004H57.424V106.159H56.556V106.004H56.37V105.849H56.215V105.725L55.688 105.694V105.57H55.192V105.415H55.006V105.26H54.851V104.95H54.51V104.764H54.293V104.609H54.138V104.485L53.983 104.454L53.952 104.392V104.299H53.828V104.144L53.797 103.989H53.611V103.834H53.456V103.679H53.301V103.524H53.177L53.146 103.369V103.214H52.96V103.059H52.619V102.904H52.34L52.309 102.594L51.968 102.563V102.439H51.844L51.813 102.129H51.627V101.974H51.534L51.503 101.881V101.819H51.162V101.664H50.821V101.509H50.666V101.354H50.511V101.199H50.325V101.044H50.17V100.858H49.984V100.734H49.86V100.548H49.674V100.269H49.519V100.176L49.488 100.083H49.333V99.959L48.992 99.928V99.773H48.682V99.618L48.651 99.463H48.341V99.308H48.031V99.153H47.876V98.998H47.69V98.936L47.659 98.874L47.38 98.843V98.688H47.039L47.008 98.626V98.533H46.853V98.409L46.667 98.378V98.254L46.357 98.223V98.068H45.365V98.223H45.241L45.21 98.533H45.334L45.365 98.657V100.114H45.551V100.889H45.706L45.768 101.354H45.892V101.974L45.923 102.594H46.078V103.059H46.233V103.214H46.419V103.524H46.574V103.679H46.667L46.76 103.71V103.989H46.574V104.299H46.419V104.609H46.264L46.233 105.229L46.078 105.26V105.694H45.675V105.849H45.52V106.004H45.303V106.159H44.931V106.314L44.559 106.345V106.779H44.342V107.12H44.187V107.275ZM45.365 94.193V94.348H45.706V94.193H47.845V94.038H48V93.883L48.31 93.852V93.728L48.651 93.697V93.573L48.93 93.542L48.961 93.387H49.147V93.263H49.426L49.457 93.17V93.077H50.108V92.922H50.418V92.643L50.759 92.612V92.488L50.883 92.457V92.333L51.038 92.302V91.992H51.224V91.93L51.255 91.837H51.565V91.558L51.751 91.527L51.782 91.062H51.937L51.906 90.597V90.132H51.782V89.977H51.565V89.667H51.441V89.512H51.224V89.357H50.914V89.202L50.573 89.171V89.047L50.449 89.016V88.892H50.263V88.737L49.922 88.706V88.582L49.798 88.551V88.427L49.612 88.396V88.272L49.271 88.241L49.24 88.086H48.961V88.024L48.93 87.931H48.62V87.776H48.496V87.621H47.969V87.466H47.318V87.342H46.667L46.636 87.404V87.466H46.171V87.621H45.83V87.776H45.675V87.931H45.52V88.086H45.334L45.303 88.396L45.21 88.427L45.179 88.582V88.706H45.024V89.233L44.993 89.357H44.9L44.869 89.481V89.977H44.683V90.442H44.528V90.752H44.683V92.767L44.838 92.798L44.869 92.891V93.883H45.024V94.038L45.086 94.193H45.365ZM61.3293 107.616H59.9963V107.461H59.6553V107.12H59.5003V106.934H59.3453V106.779H59.1593V106.252L59.0353 106.283L59.0043 105.942H58.8493V101.943H59.0043V101.416L59.0353 101.292H59.1593V100.951H59.0353L59.0043 100.827V99.587L59.0353 99.463H59.1593V97.572L59.1903 97.479L59.3143 97.448L59.3453 96.952H59.1593V96.146L59.3453 96.115V94.782H59.5003V94.255L59.5313 94.131H59.6553V92.798H59.8103L59.8413 92.674V91.961H59.9963V91.62H59.8413V90.473H59.9963V89.667L60.0273 88.768V88.644H60.1513V88.396L60.1823 88.086V87.993L60.2753 87.962H60.3373V87.466H60.4923V86.474H60.6473L60.6783 85.978H60.8333V85.327H60.9883L61.0193 85.141V84.986H61.1433L61.1743 84.893V84.831L61.3293 84.8V84.645H61.4843V84.49H61.6703V84.304H62.0113V84.149H62.8173L62.8483 84.056V83.963H63.4993V83.808H63.6543L63.8403 83.839L63.8093 83.901V83.963H64.1503V84.056L64.1813 84.149H64.4913V84.304H64.6463V84.49H64.8013L64.8323 84.552V84.645H64.9873V84.8H65.1733V84.986H65.4833V85.327H65.8243V85.482H66.0103V85.637L66.1653 85.668V85.823H66.3203V85.978L66.3513 86.164H66.6613V86.319H66.8163V86.474H67.0023V86.815H67.1573V86.97H67.3123V87.311H67.4983V87.621L67.6533 87.652V87.962H67.8083V88.148H67.9633L67.9943 88.303V88.489H68.1493V88.799H68.3043V88.985H68.4903V89.481H68.6453V89.636H68.8313V90.132H68.9863V90.318H69.1413L69.1723 90.814H69.3273V91.31H69.4823V91.465H69.6683V91.806H69.8233V92.116L69.9783 92.147L70.0093 92.643H70.1643V92.984H70.3193V93.976H70.4743V94.472H70.6603V94.782L70.8153 94.813V95.123H70.9703V95.464H71.1563V95.619H71.3113V95.96H71.4663L71.4973 96.115L71.8073 96.146V96.301H71.9623L71.9933 96.363V96.456L72.1173 96.487L72.1793 96.797L72.3033 96.828V97.138H72.1483V98.161L72.1173 98.285H71.9933V99.122H72.0553L72.1483 99.153V99.649L72.1793 100.114L72.3033 100.145V100.455H72.4893V100.951H72.6443V101.292H72.7993V101.788H72.9853V102.129H73.1403V102.935L73.2953 102.966V104.268L73.1403 104.299V104.454H73.3263V104.609H73.1403V104.95H72.9853V105.446H72.6443V105.601L72.4893 105.632V105.694L72.4583 105.787H72.3033V105.942H72.1483V106.097L71.4973 106.128L71.4663 106.252L71.3423 106.283H70.5053L70.4743 106.19V106.097H70.1643V105.601H69.8233V105.446H69.4823V105.291H69.3273V104.609H69.1413V103.462H68.9863V103.276H68.8313V101.602H68.6763L68.6453 100.951H68.4903V100.3L68.3353 100.269L68.3043 100.145L68.1803 100.114L68.1493 100.021V99.959H67.1573V100.114H63.7783L63.6543 100.145V100.3H63.1583V100.455H63.0033V100.61H62.8483V100.703L62.8173 100.765L62.5073 100.796V100.951H62.3523L62.3213 101.044V101.106L62.1663 101.137V101.943L62.3213 101.974V102.098L62.1663 102.129V102.935H62.0113V103.121H62.1663V103.276H62.0113V104.764L62.1663 104.795V105.942H62.3213L62.3523 106.252L62.1663 106.283V106.779H62.0113V107.12H61.8563L61.8253 107.182V107.275H61.6703V107.461H61.3293V107.616ZM63.1583 96.487V96.642H63.9953V96.456H65.3283V96.301H66.6613V96.146L66.8163 96.115V95.991L66.8473 95.96H67.0023V94.968L66.8473 94.937L66.8163 94.782V94.286H66.6613V93.79H66.5063V93.48H66.3513L66.3203 93.294V93.139H66.1653V92.953L66.1343 92.798H66.0103L65.9793 92.302H65.8553L65.8243 91.961H65.6693V91.62H65.4833V91.31H65.3283V90.969H65.1733V90.783L65.1423 90.628H64.9873V90.318H64.8323V90.132H64.6463V89.977H64.5223L64.4913 89.791V89.636H64.3363V89.481H64.1503V89.326H63.8093V89.481H63.4993V89.977H63.3443L63.3133 90.628H63.1583V91.124H63.3133V91.465H63.1583V92.147H63.0033V92.953L62.8483 92.984L62.8173 94.627H62.6623V95.96H62.5073V96.146H62.6623V96.301H62.8173L62.8483 96.363V96.456L63.1583 96.487ZM79.2156 108.05H78.8746V107.864H78.5336V107.709H78.3786V107.554H78.2236V107.461L78.1926 107.368H78.0376V107.213H77.8826V107.058H77.6966V106.717L77.5416 106.686V106.562L77.5106 106.159V105.88H77.3556V105.694H77.2006V103.679H77.0456V102.873L77.0146 101.974V101.85H76.8596V100.517L77.0456 100.486V100.424L77.0146 100.362L76.9216 100.331H76.8596V98.843H76.7046V97.014L76.5496 96.983L76.5186 95.65H76.3636V95.309H76.5186V95.154H76.3636V94.317H76.1776V93.635H76.0536L76.0226 93.511V93.139H75.8676V92.643H75.9916L76.0226 92.55V92.457H75.8676V91.806H75.6816V90.969L75.5266 90.938L75.4956 90.814L75.3716 90.783L75.3406 90.287H75.1856V89.14L75.0306 89.109L74.9996 88.799L74.8756 88.768L74.8446 88.613V88.458H74.6896L74.6586 88.303H74.5346L74.5036 87.931V87.59H74.6586L74.6896 87.435V87.28H74.8446V87.094L74.8756 86.939H75.0306V86.598H75.1856V86.443H75.3406L75.3716 86.102H75.4956L75.5266 85.947V85.792L75.6816 85.761V85.699L75.7126 85.606H75.8676V85.42H76.0226V85.265H76.1776V85.11L76.3636 85.079V84.955L76.5186 84.924V84.769H76.7046V84.583H77.0456V84.428H79.2156V84.273H80.5486V84.118L80.6726 84.087H83.8966L83.9276 84.025V83.932H84.5786V83.777H86.0976V83.591H86.7486V83.777H88.1126V83.932H88.2366V83.777H88.7326L88.7636 83.839V83.901L89.1046 83.932V84.087H89.4146L89.4456 84.18V84.273H89.7556V84.614L89.7866 84.924L89.9106 84.955L89.9416 85.079L90.0966 85.11V85.265L90.1276 85.42L90.1896 85.451H90.2516V85.575L90.2826 85.792V85.947H90.4376V86.319L90.4066 86.815V86.939H90.2826L90.2516 87.28H90.1276L90.0966 87.435V87.59L89.9416 87.621L89.9106 87.931L89.7866 87.962L89.7556 88.272L89.6006 88.303V88.458H89.4456L89.4146 88.613V88.799H89.1046V88.954H88.7636L88.7326 89.109L88.4226 89.14V89.264H87.9266V89.202L87.8956 89.109H87.7406V88.954H87.5856V88.799H87.4306V88.613H87.2756L87.2446 88.303L87.0896 88.272V88.117H86.9036V87.962L86.4076 87.931V87.776H86.2526V87.869L86.2216 87.931L84.9196 87.962L84.8886 88.117H84.2376V88.272H83.5556L83.0596 88.303V88.458H82.4086L82.3776 88.365V88.303H82.2536V88.365L82.2226 88.458H81.5406V88.613L81.0446 88.644V88.799H79.8976V88.954H79.5566L79.5256 91.62H79.7116V93.139H79.8666L79.8976 93.635H80.0526V94.627H80.2076V94.813L80.2386 94.968H80.3626L80.3936 95.123L80.5486 95.154V95.309H80.8896V95.464L86.2216 95.495L86.2526 95.557V95.619L86.3766 95.65H86.9036V95.836H87.7406V95.991H88.4226V96.146H88.9186L88.9496 96.332H89.0736L89.1046 96.487H89.2596V96.642H89.4146V96.797L89.6006 96.828V97.014H89.7556V97.076L89.7866 97.138L89.9416 97.169V97.479H90.0966V97.634L90.2516 97.665V98.502H90.1276L90.0966 98.812L89.9416 98.843L89.9106 98.998L89.7556 99.029V99.339H89.6006V99.494H89.1046V99.649H87.4306V99.525L87.0896 99.494V99.649H84.9196L84.8886 99.742V99.835H83.7106V99.99H83.6176L83.0286 100.021H82.5636V100.176H81.7266L81.6956 100.331H81.5716L81.5406 100.486L81.3856 100.517V100.858H81.2306V103.028H81.3856V103.865H81.5406V104.113L81.5716 104.361H81.6956L81.7266 104.485V105.198H81.5716L81.5406 105.632V106.035H81.3856V106.221H81.2306V106.376H81.0446V106.531H80.8896L80.8586 106.872H80.7036V107.058H80.5486V107.213H80.3936V107.368H79.8976L79.8666 107.461V107.554H79.5256V107.709H79.3706V107.864H79.2156V108.05ZM100.732 107.027H98.748V106.872L98.438 106.841V106.686H98.252V106.531H98.097V105.694H97.942V105.57L97.911 105.26V105.074H97.756V104.547H97.601V103.524L97.57 103.4L97.446 103.369L97.415 101.726H97.26V98.409H97.105V97.107H96.95V95.464H96.795V95.309L96.764 94.1V92.984L96.64 92.953L96.609 91.341L96.454 91.31L96.423 91.062V90.845H96.268V90.008L96.082 89.977V89.171H95.927V88.83H95.803V88.675H95.4L95.276 88.644V88.52H93.447V88.365H90.006V88.52H89.324V88.365L89.169 88.334H89.014L88.983 88.241V88.179L88.828 88.148V88.024H88.673V87.683H88.518V87.559L88.487 87.311V87.187H88.332V86.877L88.177 86.846L88.146 86.66L88.022 86.691L87.991 86.536L87.836 86.505L87.805 86.443V86.35H87.681V85.885H87.805L87.836 85.544H87.991V85.389H88.146V84.893L88.332 84.862V84.707H88.487V84.614L88.518 84.552L89.138 84.521V84.366H90.006V84.242L90.316 84.18V84.025H92.114V84.18H92.92L93.819 84.211L93.943 84.242L93.974 84.366L94.78 84.397V84.521L95.555 84.552H96.609V84.707H101.724V84.552H101.879V84.707H102.716V84.831L102.871 84.862L103.119 84.893H103.212V85.017L103.553 85.048V85.203H104.08L104.204 85.234V85.358L105.537 85.389V85.513L105.692 85.544V85.73H105.847V85.854L106.033 85.885V85.947L106.002 86.009H106.188V86.195H106.343V86.319L106.529 86.35V86.536H106.684V86.598L106.715 86.691L106.808 86.722H106.87V86.877H106.994V88.024H106.87V88.675H106.684V89.016H106.529V89.171H106.188V89.326L106.002 89.357V89.512H105.692V89.667H103.212V89.512H102.871V89.357H102.406V89.171L101.91 89.14V89.016H101.817L101.569 88.985H101.383V88.83H100.577V88.985L100.391 89.016V89.171H100.267L100.236 89.295L100.205 89.853L100.236 90.349L100.267 90.504H100.391V91.217L100.422 91.961L100.546 91.992L100.577 92.085V95.619H100.732V95.774L100.763 95.991L100.794 96.115H100.887L100.918 96.301V98.409H101.073L101.104 100.579L101.228 100.61L101.259 100.703V101.075H101.383V103.059H101.538V103.4H101.724V104.733H101.879V105.694H101.724V106.19L101.538 106.221V106.376H101.383V106.531H101.259V106.686H100.918V106.841H100.763L100.732 106.965V107.027Z" fill="#EA33A4"/>
            </svg>
            <p class="text-center w-full whitespace-break-spaces">Created at aicardcraft.com using the prompt: ${order.prompt}</p>
        </div>
        <img id="outer-front" src="${"https://"+image_url_upscaled}" style="width: 1683px; height: 1712px; object-fit: cover;" />
        <div style=""></div>
        <div id="inside-front" style="width: 1683px; height: 1712px;"></div>
        <div id="inside-back" class="flex flex-col justify-between items-center" style="width: 1683px; height: 1712px; padding-left: 225px; padding-top: 250px; padding-bottom:250px; padding-right:250px; font-size: 48px; text-align: center;">
            <div id="top-message" class="text-center">${order.top_message}</div>
            <div id="middle-message" style="font-size: 64px;" class="text-center whitespace-break-spaces">${order.middle_message}</div>
            <div id="bottom-message" class="text-center">${order.bottom_message}</div>
        </div>
    </body>
    </html>
    `
    await generateImage(htmlContent).then(async (imageBuffer) => {
        await uploadToDigitalOcean(imageBuffer, artwork_id).then((url) => {
            return;
        });
        return;
    });
    await fetch(`${process.env.HOST_URL}/api/place-prodigi-order`, {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
        },
        body: JSON.stringify({
            order
        }),
    })
    return res.status(200).json({ success: true });
}